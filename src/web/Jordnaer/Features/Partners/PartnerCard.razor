@inject IPartnerService PartnerService

@if (!string.IsNullOrEmpty(Partner.Link))
{
    <MudLink Href="@Partner.Link" Target="_blank" Underline="Underline.None" OnClick="HandleClickAsync">
        <MudCard Elevation="5" Class="mt-5 card-hover" Style="max-width: 300px">
            <MudCardContent>
                @if (!string.IsNullOrEmpty(Partner.LogoUrl))
                {
                    <MudImage Fluid Src="@Partner.LogoUrl" Alt="@($"{Partner.Name} logo")" />
                }
                @if (!string.IsNullOrEmpty(Partner.Name))
                {
                    <MudText Typo="Typo.h5">@Partner.Name</MudText>
                }
                @if (!string.IsNullOrEmpty(Partner.Description))
                {
                    <MudText Class="mt-2" Typo="Typo.subtitle1">@Partner.Description</MudText>
                }
            </MudCardContent>
        </MudCard>
    </MudLink>
}
@code
{
    [Parameter]
    public required Partner Partner { get; set; }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && Partner.Id != Guid.Empty)
        {
            await PartnerService.RecordImpressionAsync(Partner.Id);
        }
    }

    private async Task HandleClickAsync()
    {
        if (Partner.Id != Guid.Empty)
        {
            await PartnerService.RecordClickAsync(Partner.Id);
        }
    }
}
