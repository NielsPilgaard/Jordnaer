@if (GroupMembers is null)
{
    <MudLoading Overlap="false" Loading="true" />
}
else
{
    <MudList ReadOnly="CurrentUserIsAdmin" T="RenderFragment">
        <MudListSubheader>
            @if (CurrentUserIsAdmin)
            {
                <MudListItem Icon="@Icons.Material.Filled.Edit"
                             Href="@($"/groups/{GroupName}/members".Sanitize())">
                    Medlemmer
                </MudListItem>
            }
            else
            {
                <MudListItem>
                    <MudText Typo="Typo.h6">Medlemmer</MudText>
                </MudListItem>
            }
        </MudListSubheader>
        <MudDivider />
        @foreach (var member in GroupMembers)
        {
            <MudListItem Href="@($"/{member.UserName.Sanitize()}")">
                <MudAvatar Size="Size.Large" Class="mr-3">
                    <MudImage Src="@member.ProfilePictureUrl" loading="lazy" Alt="Avatar" />
                </MudAvatar>
                <div class="d-flex align-center gap-2">
                    <MudText>@member.DisplayName.Sanitize()</MudText>
                    @if (member.OwnershipLevel == OwnershipLevel.Owner)
                    {
                        <MudChip Size="Size.Small" Color="Color.Primary" Variant="Variant.Filled">Ejer</MudChip>
                    }
                    else if (member.PermissionLevel == PermissionLevel.Admin)
                    {
                        <MudChip Size="Size.Small" Color="Color.Info" Variant="Variant.Outlined">Admin</MudChip>
                    }
                </div>
            </MudListItem>
        }
    </MudList>
}
@code {
    [Parameter, EditorRequired]
    public string? GroupName { get; set; }

    [Parameter, EditorRequired]
    public bool CurrentUserIsAdmin { get; set; } = false;

    [Parameter, EditorRequired]
    public required List<GroupMemberSlim>? GroupMembers { get; set; }
}