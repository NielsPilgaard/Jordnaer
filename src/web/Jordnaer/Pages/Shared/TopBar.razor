@inject NavigationManager Navigation

<MudAppBar Fixed="false" Elevation="0" Dense="false"
	Style="@($"background: {JordnaerTheme.CustomTheme.PaletteLight.BackgroundGray}")">

	@* Desktop Navigation - Icons with Labels *@
	<MudHidden Breakpoint="Breakpoint.SmAndDown">
		<div style="display: flex; gap: 4px;">
			<MudButton Href="/" StartIcon="@Icons.Material.Filled.Home" Variant="Variant.Text"
				Class="topbar-nav-link font-open-sans-semibold" Style="@JordnaerPalette.BlueBody.ToTextColor()">
				Hjem
			</MudButton>
			<MudButton Href="/users" StartIcon="@Icons.Material.Filled.PersonSearch" Variant="Variant.Text"
				Class="topbar-nav-link font-open-sans-semibold" Style="@JordnaerPalette.BlueBody.ToTextColor()">
				Søg
			</MudButton>
			<MudButton Href="/groups" StartIcon="@Icons.Material.Filled.Groups" Variant="Variant.Text"
				Class="topbar-nav-link font-open-sans-semibold" Style="@JordnaerPalette.BlueBody.ToTextColor()">
				Grupper
			</MudButton>

			<Feature Name="@FeatureFlags.Posts">
				<MudButton Href="/posts" StartIcon="@Icons.Material.Filled.Feed" Variant="Variant.Text"
					Class="topbar-nav-link font-open-sans-semibold" Style="@JordnaerPalette.BlueBody.ToTextColor()">
					Opslag
				</MudButton>
			</Feature>

			<AuthorizeView>
				<Authorized>
					<MudButton Href="/chat" StartIcon="@Icons.Material.Filled.Chat" Variant="Variant.Text"
						Class="topbar-nav-link font-open-sans-semibold" Style="@JordnaerPalette.BlueBody.ToTextColor()">
						Chat
					</MudButton>
				</Authorized>
			</AuthorizeView>
		</div>
	</MudHidden>

	@* Mobile Navigation - Drawer Menu *@
	<MudHidden Breakpoint="Breakpoint.SmAndDown" Invert>
		<MudIconButton Icon="@Icons.Material.Filled.Menu" Style="@JordnaerPalette.BlueBody.ToTextColor()"
			OnClick="ToggleDrawer" Size="Size.Medium" />

		<MudDrawer @bind-Open="_drawerOpen" Anchor="Anchor.Left" Elevation="1" Variant="DrawerVariant.Temporary"
			ClipMode="DrawerClipMode.Always" Width="280px">
			<MudDrawerHeader
				Style="@($"{JordnaerPalette.YellowBackground.ToBackgroundColor()}; display: flex; justify-content: center; align-items: center;")"
				Class=px-4>
				<MudImage Src="/images/minimoeder_logo.png" Alt="Mini Møder" Height="80" />
			</MudDrawerHeader>
			<MudNavMenu>
				<MudNavLink Href="/" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Home">Hjem</MudNavLink>
				<MudNavLink Href="/users" Icon="@Icons.Material.Filled.PersonSearch">Søg</MudNavLink>
				<MudNavLink Href="/groups" Icon="@Icons.Material.Filled.Groups">Grupper</MudNavLink>

				<Feature Name="@FeatureFlags.Posts">
					<MudNavLink Href="/posts" Icon="@Icons.Material.Filled.Feed">Opslag</MudNavLink>
				</Feature>

				<AuthorizeView>
					<Authorized>
						<MudNavLink Href="/chat" Icon="@Icons.Material.Filled.Chat">Chat</MudNavLink>
					</Authorized>
				</AuthorizeView>
			</MudNavMenu>
		</MudDrawer>
	</MudHidden>

	<MudSpacer />

	<AuthorizeView>
		<Authorized>
			<MudHidden Breakpoint="Breakpoint.SmAndDown">
				<MudButton Href="/profile" StartIcon="@Icons.Material.Filled.Person" Variant="Variant.Text"
					Class="topbar-nav-link font-open-sans-semibold" Style="@JordnaerPalette.BlueBody.ToTextColor()">
					Profil
				</MudButton>
			</MudHidden>
			<MudHidden Breakpoint="Breakpoint.SmAndDown" Invert>
				<MudIconButton Href="/profile" Icon="@Icons.Material.Filled.Person"
					Style="@JordnaerPalette.BlueBody.ToTextColor()" Size="Size.Medium" />
			</MudHidden>
		</Authorized>
		<NotAuthorized>
			<MudHidden Breakpoint="Breakpoint.SmAndDown">
				<MudButton Href="/Account/Register" StartIcon="@Icons.Material.Filled.Login" Variant="Variant.Outlined"
					Class="font-open-sans-semibold"
					Style="@($"{JordnaerPalette.BlueBody.ToTextColor()}; border-color: {JordnaerPalette.BlueBody}")">
					Opret konto
				</MudButton>
			</MudHidden>
			<MudHidden Breakpoint="Breakpoint.SmAndDown" Invert>
				<MudIconButton Href="/Account/Register" Icon="@Icons.Material.Filled.Login" Variant="Variant.Outlined"
					Style="@($"{JordnaerPalette.BlueBody.ToTextColor()}; border-color: {JordnaerPalette.BlueBody}")"
					Size="Size.Medium" />
			</MudHidden>
		</NotAuthorized>
	</AuthorizeView>
</MudAppBar>

@code {
	private bool _drawerOpen = false;

	private void ToggleDrawer()
	{
		_drawerOpen = !_drawerOpen;
	}
}